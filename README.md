# Adapting Diffusion Models for Data Augmentation in Medical Imaging Domains

This project is from my freshman year summer at Columbia University and it aimed to show that diffusion models, in this case, [Denoising diffusion probabilistic models](https://proceedings.neurips.cc/paper/2020/file/4c5bcfec8584af0d967f1ab10179ca4b-Paper.pdf), can be used in the generation of in radiological scans of normal and diseased individuals in the NIH chest x-ray dataset—and as a result augment the dataset. The results were used to train an ensemble of binary classifiers which were then made intepretable using integrated gradients from the paper, [Axiomatic Attribution of Deep Networks](https://dl.acm.org/doi/10.5555/3305890.3306024).

The dataset used to train the diffusion models is based on that gathered by the NIH and contains over 112,000 anonymized frontal-view chest radiographs from more than 30,000 patients. 

Workflow of the project:

![Symposium Poster](results/ASIIMWE.ArnoldCalebPoster.png)

Some diffusion results of a mass and consolidation in the left lung:

![Diffusion Mass](results/diffusion_mass_71.gif)![Diffusion Consolidation](results/diffusion_consolidation.gif)

---

### Similar research, in the field of medical image generation 

(Credit: https://github.com/amirhossein-kz/Awesome-Diffusion-Models-in-Medical-Imaging)

**Conversion of the Mayo LDCT Data to Synthetic Equivalent through the Diffusion Model for Training Denoising Networks with a Theoretically Perfect Privacy** \
*Yongyi Shi, Ge Wang* \
[16th Jan., 2023] [arXiv, 2023] \
[[Paper](https://arxiv.org/abs/2301.06604)] 

**Generating Realistic 3D Brain MRIs Using a Conditional Diffusion Probabilistic Model** \
*Wei Peng, Ehsan Adeli, Qingyu Zhao, Kilian M Pohl* \
[15th Dec., 2022] [arXiv, 2022] \
[[Paper](https://arxiv.org/abs/2212.08034)] 

**SADM: Sequence-Aware Diffusion Model for Longitudinal Medical Image Generation** \
*Jee Seok Yoon, Chenghao Zhang, Heung-Il Suk, Jia Guo, Xiaoxiao Li* \
[16th Dec., 2022] [arXiv, 2022] \
[[Paper](https://arxiv.org/abs/2212.08228)]

**Diffusion Probabilistic Models beat GANs on Medical Images** \
*Gustav Müller-Franzes, Jan Moritz Niehues, Firas Khader, Soroosh Tayebi Arasteh, Christoph Haarburger, Christiane Kuhl, Tianci Wang, Tianyu Han, Sven Nebelung, Jakob Nikolas Kather, Daniel Truhn* \
[14th Dec., 2022] [arXiv, 2022] \
[[Paper](https://arxiv.org/abs/2212.07501)] 

**Improving dermatology classifiers across populations using images generated by large diffusion models** \
*Luke W. Sagers, James A. Diao, Matthew Groh, Pranav Rajpurkar, Adewole S. Adamson, Arjun K. Manrai* \
[23rd Nov., 2022] [NeurIPS Workshop, 2022] \
[[Paper](https://arxiv.org/abs/2211.13352)] 

**Seeing Beyond the Brain: Conditional Diffusion Model with Sparse Masked Modeling for Vision Decoding** \
*Zijiao Chen, Jiaxin Qing, Tiange Xiang, Wan Lin Yue, Juan Helen Zhou* \
[13th Nov., 2022] [arXiv, 2022] \
[[Paper](https://arxiv.org/abs/2211.06956)] 

**An unobtrusive quality supervision approach for medical image annotation** \
*Sonja Kunzmann, Mathias Öttl, Prathmesh Madhu, Felix Denzinger, Andreas Maier* \
[11th Nov., 2022] [arXiv, 2022] \
[[Paper](https://arxiv.org/abs/2211.06146)] 

**Medical Diffusion: Denoising Diffusion Probabilistic Models for 3D Medical Image Generation** \
*Firas Khader, Gustav Mueller-Franzes, Soroosh Tayebi Arasteh, Tianyu Han, Christoph Haarburger, Maximilian Schulze-Hagen, Philipp Schad, Sandy Engelhardt, Bettina Baessler, Sebastian Foersch, Johannes Stegmaier, Christiane Kuhl, Sven Nebelung, Jakob Nikolas Kather, Daniel Truhn* \
[7th Nov., 2022] [arXiv, 2022] \
[[Paper](https://arxiv.org/abs/2211.03364)] [[Github](https://github.com/FirasGit/medicaldiffusion)]

**Generation of Anonymous Chest Radiographs Using Latent Diffusion Models for Training Thoracic Abnormality Classification Systems** \
*Kai Packhäuser, Lukas Folle, Florian Thamm, Andreas Maier* \
[2nd Nov., 2022] [arXiv, 2022] \
[[Paper](https://arxiv.org/abs/2211.01323)] 

**Spot the fake lungs: Generating Synthetic Medical Images using Neural Diffusion Models** \
*Hazrat Ali, Shafaq Murad, Zubair Shah* \
[2nd Nov., 2022] [arXiv, 2022] \
[[Paper](https://arxiv.org/abs/2211.00902)] 

**A Morphology Focused Diffusion Probabilistic Model for Synthesis of Histopathology Images** \
*Puria Azadi Moghadam, Sanne Van Dalen, Karina C. Martin, Jochen Lennerz, Stephen Yip, Hossein Farahani, Ali Bashashati* \
[27th Sep., 2022] [arXiv, 2022] \
[[Paper](https://arxiv.org/abs/2209.13167)] 

**Brain Imaging Generation with Latent Diffusion Models** \
*Walter H. L. Pinaya, Petru-Daniel Tudosiu, Jessica Dafflon, Pedro F da Costa, Virginia Fernandez, Parashkev Nachev, Sebastien Ourselin, M. Jorge Cardoso* \
[15th Sep., 2022] [MICCAI Workshop, 2022] \
[[Paper](https://arxiv.org/abs/2209.07162)] 

**A Diffusion Model Predicts 3D Shapes from 2D Microscopy Images** \
*Dominik J. E. Waibel, Ernst Röell, Bastian Rieck, Raja Giryes, Carsten Marr* \
[30th Aug., 2022] [arXiv, 2022] \
[[Paper](https://arxiv.org/abs/2208.14125)] [[Github](https://github.com/marrlab/dispr)]

**Diffusion Deformable Model for 4D Temporal Medical Image Generation** \
*Boah Kim, Jong Chul Ye* \
[27th Jan., 2022] [MICCAI, 2022] \
[[Paper](https://arxiv.org/abs/2206.13295)] [[Github](https://github.com/torchddm/ddm)]

**Three-Dimensional Medical Image Synthesis with Denoising Diffusion Probabilistic Models** \
*Zolnamar Dorjsembe, Sodtavilan Odonchimed, Furen Xiao* \
[22nd Apr., 2022] [MIDL, 2022] \
[[Paper](https://arxiv.org/abs/2206.13295)] [[Github](https://github.com/torchddm/ddm)]




